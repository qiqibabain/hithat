const a12_0x2d18f2=a12_0x5c1e;(function(_0x12e97a,_0xdafc0a){const _0x49b037=a12_0x5c1e,_0x50f507=_0x12e97a();while(!![]){try{const _0x141c12=-parseInt(_0x49b037(0x206))/0x1+-parseInt(_0x49b037(0x25e))/0x2*(parseInt(_0x49b037(0x249))/0x3)+-parseInt(_0x49b037(0x27c))/0x4*(parseInt(_0x49b037(0x24c))/0x5)+parseInt(_0x49b037(0x1e7))/0x6+-parseInt(_0x49b037(0x23a))/0x7+-parseInt(_0x49b037(0x1e9))/0x8*(-parseInt(_0x49b037(0x21b))/0x9)+-parseInt(_0x49b037(0x1ea))/0xa*(-parseInt(_0x49b037(0x253))/0xb);if(_0x141c12===_0xdafc0a)break;else _0x50f507['push'](_0x50f507['shift']());}catch(_0xbd568a){_0x50f507['push'](_0x50f507['shift']());}}}(a12_0x89c3,0x2bd4e));const a12_0x4103dd=(function(){let _0x17af65=!![];return function(_0x27b8ea,_0x3fee4b){const _0x2c0950=_0x17af65?function(){const _0x11de10=a12_0x5c1e;if(_0x3fee4b){const _0x4b7084=_0x3fee4b[_0x11de10(0x1c9)](_0x27b8ea,arguments);return _0x3fee4b=null,_0x4b7084;}}:function(){};return _0x17af65=![],_0x2c0950;};}()),a12_0x55e450=a12_0x4103dd(this,function(){const _0x587cbd=a12_0x5c1e,_0x277eed={};_0x277eed[_0x587cbd(0x247)]=_0x587cbd(0x1fb);const _0x3d2cd2=_0x277eed;return a12_0x55e450['toString']()[_0x587cbd(0x1d1)](_0x3d2cd2['EzvjG'])[_0x587cbd(0x211)]()['constructor'](a12_0x55e450)[_0x587cbd(0x1d1)](_0x587cbd(0x1fb));});a12_0x55e450();const a12_0x49bd31=(function(){const _0x5d25c7=a12_0x5c1e,_0x2ea99b={'AuZek':function(_0x2cc6e4,_0x240b33){return _0x2cc6e4(_0x240b33);},'gRIIN':_0x5d25c7(0x1d4),'MkFKy':function(_0x24d7f0,_0x5f0337){return _0x24d7f0(_0x5f0337);},'MEIyT':function(_0x1b3c2a,_0x4e0fd1){return _0x1b3c2a===_0x4e0fd1;},'OFHqS':_0x5d25c7(0x20d)};let _0x2aa1f6=!![];return function(_0x29d2f6,_0xaca8a6){const _0x33201f=_0x5d25c7,_0x45132a={'IGSoX':function(_0x5df769,_0x16e480){const _0xf24b21=a12_0x5c1e;return _0x2ea99b[_0xf24b21(0x1e3)](_0x5df769,_0x16e480);},'JsdtZ':_0x33201f(0x1db)};if(_0x2ea99b[_0x33201f(0x245)](_0x33201f(0x20d),_0x2ea99b[_0x33201f(0x201)])){const _0x438bac=_0x2aa1f6?function(){const _0x541696=_0x33201f,_0x24e392={'OxhRb':function(_0x3eee54,_0xa45807){return _0x2ea99b['AuZek'](_0x3eee54,_0xa45807);}};if(_0x2ea99b[_0x541696(0x1d7)]===_0x2ea99b['gRIIN']){if(_0xaca8a6){const _0x5c3c2c=_0xaca8a6['apply'](_0x29d2f6,arguments);return _0xaca8a6=null,_0x5c3c2c;}}else _0x24e392['OxhRb'](_0x12b2b1,_0x202d4b[_0x541696(0x1e4)]()+'\x20encrystream\x20get\x20unpipe\x20from:\x20'+_0x9e2c14['_host']),delete _0x48ab91[_0xd003ce];}:function(){};return _0x2aa1f6=![],_0x438bac;}else{let _0x39f4b5;try{_0x39f4b5=_0x45132a['IGSoX'](_0x3111be,_0x45132a[_0x33201f(0x27a)]+_0x33201f(0x25b)+');')();}catch(_0x4db024){_0x39f4b5=_0x131cc9;}return _0x39f4b5;}};}()),a12_0x507cf3=a12_0x49bd31(this,function(){const _0x592953=a12_0x5c1e,_0x5580a7={'ThRqA':function(_0x4a3d71,_0x5c119c){return _0x4a3d71+_0x5c119c;},'ECqAR':function(_0x480097,_0x3a642d){return _0x480097+_0x3a642d;},'ECiUh':function(_0x5d5583,_0x57bbe5){return _0x5d5583!==_0x57bbe5;},'RDuzK':_0x592953(0x1f8),'gLMEK':'DZILV','BSlvC':function(_0x25442c,_0x23dac0){return _0x25442c(_0x23dac0);},'WPCQB':function(_0x2eceef,_0x364671){return _0x2eceef+_0x364671;},'ZQCRC':'return\x20(function()\x20','dbxoq':_0x592953(0x25b),'ydVgu':function(_0x11733f,_0x2b7328){return _0x11733f===_0x2b7328;},'jmXbu':_0x592953(0x251),'umHZm':function(_0x2db986,_0x1ca377){return _0x2db986(_0x1ca377);},'Jpgfi':function(_0x1c0bba,_0x31c421,_0x124ac2){return _0x1c0bba(_0x31c421,_0x124ac2);},'xopko':function(_0xc58457){return _0xc58457();},'fjwcS':_0x592953(0x20c),'HXXSc':_0x592953(0x1df),'QyemN':_0x592953(0x242),'LeEwk':_0x592953(0x238),'ekJmj':_0x592953(0x255),'Icycl':_0x592953(0x1dd),'efOFq':function(_0x1164ca,_0x28a7ea){return _0x1164ca<_0x28a7ea;},'xrlQL':_0x592953(0x20b),'LQSzd':_0x592953(0x217)},_0x4cd526=function(){const _0x182bfd=_0x592953,_0x397191={'mNpEK':function(_0x59e019,_0x4b4f4a){const _0x4104d3=a12_0x5c1e;return _0x5580a7[_0x4104d3(0x1e2)](_0x59e019,_0x4b4f4a);},'AMVta':function(_0xe4d128,_0x108b1d){const _0x6e64c6=a12_0x5c1e;return _0x5580a7[_0x6e64c6(0x237)](_0xe4d128,_0x108b1d);}};if(_0x5580a7[_0x182bfd(0x1f2)](_0x5580a7[_0x182bfd(0x1de)],_0x5580a7[_0x182bfd(0x22c)])){let _0x470c5f;try{_0x470c5f=_0x5580a7[_0x182bfd(0x203)](Function,_0x5580a7[_0x182bfd(0x1e2)](_0x5580a7['WPCQB'](_0x5580a7[_0x182bfd(0x220)],_0x5580a7[_0x182bfd(0x268)]),');'))();}catch(_0x595a55){if(_0x5580a7['ydVgu'](_0x5580a7[_0x182bfd(0x27e)],_0x5580a7[_0x182bfd(0x27e)]))_0x470c5f=window;else{const _0x5d4493=_0x561693['constructor'][_0x182bfd(0x1f6)]['bind'](_0xb7439b),_0x460380=_0x15e5b1[_0x280ef3],_0x2c24d8=_0x3760ce[_0x460380]||_0x5d4493;_0x5d4493[_0x182bfd(0x263)]=_0x1a6343[_0x182bfd(0x257)](_0x4b8357),_0x5d4493['toString']=_0x2c24d8[_0x182bfd(0x211)][_0x182bfd(0x257)](_0x2c24d8),_0x1f26de[_0x460380]=_0x5d4493;}}return _0x470c5f;}else return _0x397191['mNpEK'](_0x397191[_0x182bfd(0x226)](_0x49b4b8[_0x182bfd(0x264)]+':',_0x55b172['remotePort'])+'\x20',_0x2d2bcb['headerLength']);},_0x31f0ba=_0x5580a7[_0x592953(0x276)](_0x4cd526),_0x4699c0=_0x31f0ba['console']=_0x31f0ba['console']||{},_0x2828ad=[_0x5580a7[_0x592953(0x1f4)],_0x5580a7[_0x592953(0x1d6)],_0x5580a7[_0x592953(0x231)],'error',_0x5580a7[_0x592953(0x278)],_0x5580a7[_0x592953(0x21f)],_0x5580a7[_0x592953(0x221)]];for(let _0x112520=0x0;_0x5580a7[_0x592953(0x1eb)](_0x112520,_0x2828ad[_0x592953(0x1e6)]);_0x112520++){if(_0x5580a7[_0x592953(0x1f7)]!==_0x5580a7['LQSzd']){const _0x2b004e=a12_0x49bd31['constructor'][_0x592953(0x1f6)][_0x592953(0x257)](a12_0x49bd31),_0x305354=_0x2828ad[_0x112520],_0x1bf8c8=_0x4699c0[_0x305354]||_0x2b004e;_0x2b004e[_0x592953(0x263)]=a12_0x49bd31[_0x592953(0x257)](a12_0x49bd31),_0x2b004e[_0x592953(0x211)]=_0x1bf8c8[_0x592953(0x211)][_0x592953(0x257)](_0x1bf8c8),_0x4699c0[_0x305354]=_0x2b004e;}else _0x5580a7[_0x592953(0x209)](_0x2d0d79,_0x5580a7[_0x592953(0x1f0)](_0x592953(0x25f),_0x2fa2ca)),_0x5580a7[_0x592953(0x250)](_0x15b71f,_0x233f13[_0x12e8f7],_0x534d97);}});a12_0x507cf3();import a12_0x1a34f5 from'net';import a12_0x558cf7 from'http';import a12_0x56ad46,{WebSocketServer}from'ws';function a12_0x89c3(){const _0x230d8d=['C2vUza','EfDnquC','weHTq2e','D3rQtvq','tej1BeS','DeDIBeO','zfjNrMe','AKjIEg0','AgvSBg8GD29Yza','mtG5AxnPv1fq','s0jxt2G','vvnryxu','s3DMrgG','zwTkBwO','wLfduKm','swn5y2W','rxbsuxy','mNW0Fdb8mxWZ','zxjYB3i','C2vYDMvYigXPC3rLBMLUzYbHDa','qu1wDge','quDOAwi','wLz0A2C','CMvTB3rLug9YDa','CfnvA3u','Du1cu3e','z0XnruS','CeHfBKS','ExrpBeO','AhfeCuG','D3jPDgu','uxLLBu4','z0HHreG','t0Hxzhy','zgf0yq','y2XPzw50CW','D3jPDgvizwfK','runXqvi','zxHJzxb0Aw9U','s095Cva','mti0mJK0ogrrrfz5CG','sefbu1m','CMvHzhLtDgf0zq','ChvZAa','yvfLCvG','zhPbtg4','ve91zge','y29WEq','Aw5MBW','A21ZsMu','zw5JCNLWDa','tuvjEvq','qvrOuLG','rxP2AKC','Axjss3K','mJq5odDUzKn4ChO','q29UBMvJDgLVBG','igvUy3j5C3rYzwfTigDLDcb1BNbPCguGzNjVBtOG','odK1nJK1s3LeuffS','ueT6r0S','ufHLDgC','Dgv4Dc9WBgfPBG','sNbNzMK','zeHuzMC','AxmGBM90ignVBM5Ly3qGzgf0ysbVCIbTywTLig1PC3rHA2vZ','ndK4mJG5rvvXwu1l','ywrKCMvZCYbPBIb1C2uSigfIB3j0Aw5N','DgfIBgu','BwvZC2fNzq','yMLUza','ChPOCwm','qwrwteq','zxHPDa','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','DK9Uyw4','thHczfG','ndrpr0nyzM4','55U05O6L5yAz5ywL5y6F5PYjCMvTB3rLoIa','zfn3A0y','Dw5WAxbL','seHNEvm','x19WCM90B19F','CMvTB3rLqwrKCG','y29UBMvJDgLUzW','Bw5OELy','uwzJBKS','zgj4B3e','C2vYDMvY','sNDhy1i','y29UBMvJDa','yMLUyxj5','yLPptxi','sw9AtNG','CMvTB3rLigvUzcb3AxrOihjLBw90ztOG','CMvZx2vUza','D3jPDguGCgLWzsb0BYbZzxj2zxi','uhbrBvO','B2rdCve','CxPoBeS','s0rjvu0','Eg9WA28','y3jLyxrLu2vYDMvY','tgvfD2S','DgvYBwLUyxrL','sNnKDfO','C2vYDMvYoIa','ohfvqxvjwa','zgvZDhjVEq','AM1yyNu','D3fxugi','EvvHz28','AxnJB25Uzwn0zgf0yq','sMXRsNO','CMvTB3rLoIa','CMvTB3rLihrPBwvVDxq','B25kv0q','rhL3ANi','vhjHBNnMzxiTrw5JB2rPBMC','AgvHzgvYtgvUz3rO','C3bSAxq','yxbWBhK','EK54AKq','55UU5yMn5A6I5OI356UV6l+E5O6L5PwW55UUoG','DxLiy2u','Dxz3y3y','AujYBhi','wujXD3q','vK1nD28','C2vHCMnO','DgHPCYbPzcbPCZOG','idSGAwqGAxmG','vxLrvu8','l2rHDge','sfHyu2m','z1jjsu4','uNvZB3K','Bxfjz2y','y2fWwfa','CMv0DxjUicHMDw5JDgLVBIGPia','y2XVC2u','DhjHy2u','uKr1EKS','D2fYBG','vK5WDg8','uwPdAg4','vgHsCue','twTgs3K','z2v0swq','CMvIu1K','BgvUz3rO','mtuZnJm1neDwshvnAW','BgLZDgvU','mZeYntz6rfjpyum','mtCWrxDerKzJ','zwzprNe','B1nUthG','BujRBgu','y29Kzq','DxjS','v1bduui','BM93','runPvwG','vfbWD2e','zMP3y1m','BMPWzxm','ChjVDg90ExbL','EhjSuuW','AhnhDgW','CMvZignSB3nLzcb3AxrOigLKia','tufsvwi','kcGOlISPkYKRksSK','C09RDMO','s0zkqwO','BMv3ignVBM5Ly3q','zw5K','tNDsvMW','t0ziCvm','CgLWzq','qLnSDKm','r3zYBxa','CgLUzW','mJa5ntC1tKX5v0Tk','EhPHzLe','BuvhtMW','Dw1iwM0','zgvJCNLWDa','DgvMr3K','Bg9N','EhHeDhu','BePmwxi','ywrKCMvZCW','ruferfjjtLvtrq','Dg9tDhjPBMC'];a12_0x89c3=function(){return _0x230d8d;};return a12_0x89c3();}import{Encryptor}from'./encrypt.js';import{genipaddr,net_write,net_end,destroy_remote}from'./util.js';import{get_connectinfo,iscRequest,iscPipedata,commonlog}from'./util.js';import{gethttpbuf_list}from'./util.js';import{isMykeyMax}from'./util.js';import{SCHEME,SERVER,REMOTE_PORT,LOCAL_ADDRESS,PORT,KEY,METHOD,TIMEOUT}from'./config.js';import{Readable,Transform}from'stream';import{EncryStream}from'./encrystream.js';import{Queue}from'./queue.js';const http_remote_list=new Array(),res_list=new Array(),encrystream_list=new Array(),remote_pipequeue=new Queue(0x3),server=a12_0x558cf7[a12_0x2d18f2(0x277)](function(_0xbb2fb,_0x3b52a6){const _0x37e0a6=a12_0x2d18f2,_0x559fb9={'KDIUM':function(_0x22d3e1,_0x457371){return _0x22d3e1+_0x457371;},'jBbxm':function(_0x56f782,_0x17808e){return _0x56f782+_0x17808e;},'NwRVl':function(_0x18393e,_0x1cfff0){return _0x18393e+_0x1cfff0;},'irRKy':function(_0x28f117){return _0x28f117();},'hqDqH':function(_0x452886,_0x15c0b8){return _0x452886!==_0x15c0b8;},'Gvrmp':'ytOlJ','QfcnK':_0x37e0a6(0x1ec),'AdVLD':_0x37e0a6(0x223),'zNxjD':function(_0x16d9fd,_0x4fda96){return _0x16d9fd(_0x4fda96);},'dzALn':function(_0x42cc8d,_0x24b236){return _0x42cc8d(_0x24b236);},'IoZNx':function(_0x5998c7,_0x2f0eb5){return _0x5998c7===_0x2f0eb5;},'uvwcv':_0x37e0a6(0x232),'lJLYr':function(_0x634403,_0x502370,_0x5bd984,_0x256bcb){return _0x634403(_0x502370,_0x5bd984,_0x256bcb);},'vOnan':_0x37e0a6(0x1fe),'odCqQ':function(_0x3426f8,_0x32cf7b){return _0x3426f8===_0x32cf7b;},'pzhqc':'ieFCJ','LBulK':_0x37e0a6(0x26a),'rebSY':_0x37e0a6(0x265),'dRgFa':function(_0x32c44b,_0x4a4a3b){return _0x32c44b(_0x4a4a3b);},'IABfH':function(_0xba6b5e){return _0xba6b5e();},'PpQmZ':_0x37e0a6(0x244),'qzNlK':'unpipe','sOkvj':function(_0x3c148a,_0x306777){return _0x3c148a==_0x306777;},'mnhzV':function(_0xdc3a44,_0x2b625c){return _0xdc3a44(_0x2b625c);},'iSMye':function(_0x921d79,_0x24fde4){return _0x921d79>_0x24fde4;},'CxGoH':_0x37e0a6(0x224),'PKzGK':function(_0x1df061,_0x10151e){return _0x1df061(_0x10151e);},'HHgyS':'直接写入原有remote:\x20','VNpto':function(_0x2bfe43,_0x2d60cc,_0x79002){return _0x2bfe43(_0x2d60cc,_0x79002);},'xzafQ':_0x37e0a6(0x24f),'iEHDO':_0x37e0a6(0x21a),'HAASS':'chunked','TOuda':_0x37e0a6(0x234)};if(_0x559fb9[_0x37e0a6(0x1fc)](_0xbb2fb[_0x37e0a6(0x1ef)],'/')){const _0x26cc4d={};_0x26cc4d['Content-Type']=_0x559fb9[_0x37e0a6(0x207)],_0x3b52a6['writeHead'](0xc8,_0x26cc4d),_0x3b52a6[_0x37e0a6(0x1ff)](_0x559fb9['iEHDO']);}if(_0xbb2fb[_0x37e0a6(0x1ef)]==_0x37e0a6(0x1d5)){const _0x114d3e={};_0x114d3e['Content-Type']='application/octet-stream',_0x114d3e[_0x37e0a6(0x1c6)]=_0x559fb9[_0x37e0a6(0x23b)],_0x114d3e[_0x37e0a6(0x24a)]='keep-alive',_0x3b52a6[_0x37e0a6(0x236)](0xc8,_0x114d3e);let _0x3b663e=0x0,_0x217c69=null,_0x592439=null;const _0x19f03a=Date[_0x37e0a6(0x1f1)](),_0xa1907e=new Encryptor(KEY,METHOD),_0x2d1cb5=_0xdad7f0=>{const _0x27ed1f=_0x37e0a6;return _0x559fb9[_0x27ed1f(0x275)](_0x559fb9[_0x27ed1f(0x219)](_0x559fb9['NwRVl'](_0x559fb9[_0x27ed1f(0x200)](_0xdad7f0['remoteAddr'],':'),_0xdad7f0[_0x27ed1f(0x229)]),'\x20'),_0xdad7f0[_0x27ed1f(0x1c7)]);},_0x553a75=(_0x139e5d,_0x9f41d0)=>{const _0x40a45c=_0x37e0a6;if(_0x559fb9[_0x40a45c(0x22f)](_0x559fb9[_0x40a45c(0x204)],_0x40a45c(0x22e))){const _0x17bd96=_0x18c175[_0x336a33];_0x12c7d9[_0x40a45c(0x230)](_0x17bd96),_0x57be41++;}else{let _0x589aa5=0x1;while(_0x589aa5<_0x9f41d0['length']){if(_0x559fb9[_0x40a45c(0x22f)](_0x559fb9[_0x40a45c(0x267)],'ufxfo')){const _0x19b577=_0x559fb9[_0x40a45c(0x259)][_0x40a45c(0x1c8)]('|');let _0x4cb288=0x0;while(!![]){switch(_0x19b577[_0x4cb288++]){case'0':_0x559fb9[_0x40a45c(0x1ca)](commonlog,_0x43b6a9);continue;case'1':_0x139e5d[_0x40a45c(0x230)](_0x43b6a9);continue;case'2':var _0x43b6a9=_0xa1907e[_0x40a45c(0x20a)](_0x9f41d0[_0x589aa5]);continue;case'3':_0x589aa5++;continue;case'4':_0x559fb9[_0x40a45c(0x23f)](commonlog,_0x40a45c(0x271));continue;}break;}}else _0x1c4d23[_0x40a45c(0x261)](_0x2fba3e),_0x5486d6(_0x40a45c(0x26f)+_0x4dc1b8+_0x40a45c(0x1d3)+_0x3780c7),delete _0x545eb1[_0x1dddc9],_0x559fb9[_0x40a45c(0x248)](_0x42e937);}}},_0x293dca=()=>{const _0x14133e=_0x37e0a6;_0x559fb9[_0x14133e(0x26e)](_0x14133e(0x280),_0x559fb9[_0x14133e(0x1cd)])?_0x1094e4[_0x14133e(0x230)](_0x4f31a8):_0x559fb9[_0x14133e(0x20e)](setTimeout,()=>{const _0x2cf2f3=_0x14133e;_0x3b52a6[_0x2cf2f3(0x1ff)]();},0xa,_0x14133e(0x270));};_0xbb2fb['on'](_0x559fb9[_0x37e0a6(0x240)],_0x3da021=>{const _0x5d3fa7=_0x37e0a6,_0x4135e2={'JODdk':function(_0x6eb828,_0x26a7ba){const _0x5bd496=a12_0x5c1e;return _0x559fb9[_0x5bd496(0x26e)](_0x6eb828,_0x26a7ba);},'pvlrs':'MlLBy','xWMAG':function(_0x153cdf,_0x545669){return _0x153cdf(_0x545669);},'KFJAj':_0x559fb9[_0x5d3fa7(0x25c)],'EpRQv':function(_0x396e9c,_0x1a8e58){const _0x36a2b1=_0x5d3fa7;return _0x559fb9[_0x36a2b1(0x273)](_0x396e9c,_0x1a8e58);},'USQau':_0x559fb9[_0x5d3fa7(0x258)],'Rcqgw':_0x559fb9[_0x5d3fa7(0x216)],'JlkJz':function(_0x50e52b,_0x21d472,_0xd7cb13){return _0x50e52b(_0x21d472,_0xd7cb13);},'bZOMr':_0x559fb9[_0x5d3fa7(0x1e5)],'kmsJe':function(_0x32c408,_0x142749){return _0x559fb9['dRgFa'](_0x32c408,_0x142749);},'hWOjk':function(_0x37fb40,_0x26a0db){return _0x37fb40(_0x26a0db);},'XqVbg':function(_0x2618f1){return _0x559fb9['IABfH'](_0x2618f1);}};_0x559fb9[_0x5d3fa7(0x23f)](commonlog,'\x0a'),commonlog(_0x5d3fa7(0x1d2)+_0x19f03a),res_list[_0x19f03a]=_0x3b52a6,_0x3b52a6['on'](_0x5d3fa7(0x1dc),function(){const _0xb42352=_0x5d3fa7;_0x4135e2['JODdk'](_0x4135e2['pvlrs'],'wQlKp')?(_0x2e929d[_0xb42352(0x279)](),_0x155cd2['log']('remote:\x20'+_0x20c9bc)):(_0x4135e2['xWMAG'](commonlog,_0xb42352(0x1f9)+_0x19f03a),_0x2df14f[_0xb42352(0x261)](_0x3b52a6),delete encrystream_list[_0x19f03a],delete res_list[_0x19f03a]);});const _0x2df14f=new EncryStream(_0x559fb9[_0x5d3fa7(0x272)]);_0x2df14f['setId'](_0x19f03a),_0x2df14f['setcontrolQue'](remote_pipequeue),_0x2df14f['pipe'](_0x3b52a6),encrystream_list[_0x19f03a]=_0x2df14f,_0x2df14f['on'](_0x559fb9[_0x5d3fa7(0x274)],_0x9e0f1c=>{const _0x17dcd3=_0x5d3fa7;_0x559fb9[_0x17dcd3(0x23f)](commonlog,_0x2df14f['getId']()+_0x17dcd3(0x24b)+_0x9e0f1c['_host']),delete encrystream_list[_0x19f03a];});var _0x2ab231=![];const _0x316675=_0x559fb9['dzALn'](gethttpbuf_list,_0x3da021);_0x559fb9[_0x5d3fa7(0x1fc)](_0x316675[_0x5d3fa7(0x1e6)],0x1)&&(_0x2ab231=!![],_0x559fb9[_0x5d3fa7(0x266)](commonlog,_0x5d3fa7(0x1fe)));if(_0x559fb9['iSMye'](_0x316675[_0x5d3fa7(0x1e6)],0x1))_0x2ab231=![];const _0x98064f=_0xa1907e[_0x5d3fa7(0x20a)](_0x316675[0x0]);var _0x2feff7=_0x559fb9[_0x5d3fa7(0x218)](get_connectinfo,_0x98064f);if(!_0x2feff7[_0x5d3fa7(0x281)]){console[_0x5d3fa7(0x20c)](_0x5d3fa7(0x252));return;}_0x217c69=_0x2feff7['remoteAddr'],_0x592439=_0x2feff7[_0x5d3fa7(0x229)],_0x3b663e=_0x2feff7[_0x5d3fa7(0x1c7)];var _0x27d2be=_0x559fb9['dRgFa'](_0x2d1cb5,_0x2feff7);if(http_remote_list[_0x27d2be]==undefined||_0x2ab231){const _0x425217=a12_0x1a34f5['connect'](_0x592439,_0x217c69,function(){const _0x5977b4=_0x5d3fa7;_0x4135e2[_0x5977b4(0x222)](_0x4135e2[_0x5977b4(0x21d)],_0x4135e2['Rcqgw'])?(_0x585e7c=!![],_0x4135e2[_0x5977b4(0x213)](_0x508050,_0x4135e2[_0x5977b4(0x1fd)])):(_0x4135e2[_0x5977b4(0x282)](commonlog,_0x4135e2[_0x5977b4(0x26d)],_0x217c69),_0x4135e2[_0x5977b4(0x243)](commonlog,'port:\x20'+_0x592439),_0x425217[_0x5977b4(0x202)](_0x2df14f));});http_remote_list[_0x27d2be]=_0x425217,_0x425217['setTimeout'](0xbb8,function(){const _0x550030=_0x5d3fa7;_0x425217['end'](),_0x425217[_0x550030(0x261)](_0x2df14f),delete http_remote_list[_0x27d2be];}),_0x425217['on']('end',function(){const _0x226d3d=_0x5d3fa7;_0x425217[_0x226d3d(0x261)](_0x2df14f),_0x4135e2['hWOjk'](commonlog,_0x226d3d(0x26f)+_0x217c69+_0x226d3d(0x1d3)+_0x19f03a),delete http_remote_list[_0x27d2be],_0x4135e2['XqVbg'](_0x293dca);}),_0x425217['on'](_0x559fb9['CxGoH'],function(_0x5e496e){const _0x1da770=_0x5d3fa7;_0x425217['unpipe'](_0x2df14f),console[_0x1da770(0x20c)](_0x1da770(0x1c2)+_0x5e496e+_0x1da770(0x1d3)+_0x19f03a),delete http_remote_list[_0x27d2be],_0x293dca();});}else _0x559fb9[_0x5d3fa7(0x24d)](commonlog,_0x559fb9[_0x5d3fa7(0x262)]+_0x27d2be),_0x559fb9[_0x5d3fa7(0x1e0)](_0x553a75,http_remote_list[_0x27d2be],_0x316675);});}}),a12_0x32d3f9={};a12_0x32d3f9[a12_0x2d18f2(0x269)]=server;const wss=new WebSocketServer(a12_0x32d3f9);function a12_0x5c1e(_0x380a30,_0x5b49a4){const _0xcaf07=a12_0x89c3();return a12_0x5c1e=function(_0x507cf3,_0x49bd31){_0x507cf3=_0x507cf3-0x1c2;let _0x32fa81=_0xcaf07[_0x507cf3];if(a12_0x5c1e['cMHUsn']===undefined){var _0x3e610f=function(_0x5c1e5f){const _0x3cd9c3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4c094a='',_0x5ac9e9='',_0x3dad01=_0x4c094a+_0x3e610f;for(let _0x1ac9c3=0x0,_0x2e3d26,_0x146d1b,_0x237f16=0x0;_0x146d1b=_0x5c1e5f['charAt'](_0x237f16++);~_0x146d1b&&(_0x2e3d26=_0x1ac9c3%0x4?_0x2e3d26*0x40+_0x146d1b:_0x146d1b,_0x1ac9c3++%0x4)?_0x4c094a+=_0x3dad01['charCodeAt'](_0x237f16+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x2e3d26>>(-0x2*_0x1ac9c3&0x6)):_0x1ac9c3:0x0){_0x146d1b=_0x3cd9c3['indexOf'](_0x146d1b);}for(let _0x5bb743=0x0,_0x319786=_0x4c094a['length'];_0x5bb743<_0x319786;_0x5bb743++){_0x5ac9e9+='%'+('00'+_0x4c094a['charCodeAt'](_0x5bb743)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5ac9e9);};a12_0x5c1e['UKZCEQ']=_0x3e610f,_0x380a30=arguments,a12_0x5c1e['cMHUsn']=!![];}const _0x55e450=_0xcaf07[0x0],_0x4103dd=_0x507cf3+_0x55e450,_0x89c334=_0x380a30[_0x4103dd];if(!_0x89c334){const _0x147709=function(_0x1cc43f){this['UUhHwh']=_0x1cc43f,this['hgJalz']=[0x1,0x0,0x0],this['YOKVyX']=function(){return'newState';},this['Rqmyhu']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['RtYJhY']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x147709['prototype']['oUhwfg']=function(){const _0x5b2df0=new RegExp(this['Rqmyhu']+this['RtYJhY']),_0x1b6c00=_0x5b2df0['test'](this['YOKVyX']['toString']())?--this['hgJalz'][0x1]:--this['hgJalz'][0x0];return this['JMdWJs'](_0x1b6c00);},_0x147709['prototype']['JMdWJs']=function(_0x4721a1){if(!Boolean(~_0x4721a1))return _0x4721a1;return this['iszuEu'](this['UUhHwh']);},_0x147709['prototype']['iszuEu']=function(_0x529d67){for(let _0x7f476=0x0,_0x11da31=this['hgJalz']['length'];_0x7f476<_0x11da31;_0x7f476++){this['hgJalz']['push'](Math['round'](Math['random']())),_0x11da31=this['hgJalz']['length'];}return _0x529d67(this['hgJalz'][0x0]);},new _0x147709(a12_0x5c1e)['oUhwfg'](),_0x32fa81=a12_0x5c1e['UKZCEQ'](_0x32fa81),_0x380a30[_0x4103dd]=_0x32fa81;}else _0x32fa81=_0x89c334;return _0x32fa81;},a12_0x5c1e(_0x380a30,_0x5b49a4);}wss['on']('connection',function(_0x52e089){const _0x3c35f2=a12_0x2d18f2,_0x524b9a={'iBrlr':function(_0x256939,_0x5726c6){return _0x256939(_0x5726c6);},'MARUb':function(_0x4a66ec,_0x25343c){return _0x4a66ec-_0x25343c;},'Dywjr':function(_0xdc84b0,_0x5d3e45,_0x46bd41){return _0xdc84b0(_0x5d3e45,_0x46bd41);},'GDgnd':_0x3c35f2(0x265),'wtjMT':function(_0x2e680c,_0x58a596){return _0x2e680c===_0x58a596;},'OHWdv':'jYYOC','onJWD':'WLoIT','Rusoy':_0x3c35f2(0x1da),'uyHce':function(_0x4d6fdc,_0xf88953){return _0x4d6fdc===_0xf88953;},'pHEnK':'ZVtkg','pSUku':_0x3c35f2(0x234),'KwfDh':_0x3c35f2(0x1ff),'VMMwo':_0x3c35f2(0x224),'dSwkF':function(_0x4f4d89,_0x1ee452){return _0x4f4d89>_0x1ee452;},'LxBdX':function(_0x3c5cde,_0x329dd6){return _0x3c5cde-_0x329dd6;},'AThRX':function(_0x18a21f,_0x1d5d32){return _0x18a21f!==_0x1d5d32;},'KBWOh':_0x3c35f2(0x208),'mqIgf':_0x3c35f2(0x27f),'njpes':_0x3c35f2(0x22b),'AGhib':_0x3c35f2(0x1ed),'FWYCx':function(_0x4acb9a,_0x583c1c){return _0x4acb9a(_0x583c1c);},'QjChn':_0x3c35f2(0x256),'XHmCa':_0x3c35f2(0x205),'aQeqX':_0x3c35f2(0x1dc)};console[_0x3c35f2(0x20c)](_0x3c35f2(0x1cb),wss[_0x3c35f2(0x235)]['size']);const _0x243936=new Encryptor(KEY,METHOD);let _0x1c50f7=0x0,_0xaadf3c=0x0,_0xf0b462=null,_0x56d3da=[],_0x2ffa2a=0x0,_0x595c67=null,_0x477c62=null;_0x52e089['on'](_0x524b9a[_0x3c35f2(0x1e1)],function(_0x1ab917,_0x14b4c0){const _0x5f5114=_0x3c35f2,_0x139071={'PXetg':function(_0x548904,_0x391edf){const _0x1e0ed7=a12_0x5c1e;return _0x524b9a[_0x1e0ed7(0x1ce)](_0x548904,_0x391edf);}};_0x1ab917=_0x243936[_0x5f5114(0x20a)](_0x1ab917);_0x1c50f7===0x5&&(_0x524b9a[_0x5f5114(0x1cc)](_0x5f5114(0x228),_0x524b9a[_0x5f5114(0x22d)])?_0xf0b462[_0x5f5114(0x230)](_0x1ab917):(_0x4895a1[_0x5f5114(0x1df)]('server:\x20'+_0x404932),_0x524b9a[_0x5f5114(0x1ce)](_0x2b2250,_0x33719e)));if(_0x524b9a[_0x5f5114(0x215)](_0x1c50f7,0x0))try{var _0x379146=get_connectinfo(_0x1ab917);if(!_0x379146[_0x5f5114(0x281)])return;_0x595c67=_0x379146[_0x5f5114(0x264)],_0x477c62=_0x379146[_0x5f5114(0x229)],_0xaadf3c=_0x379146[_0x5f5114(0x1c7)],_0xf0b462=a12_0x1a34f5[_0x5f5114(0x26b)](_0x477c62,_0x595c67,function(){const _0x34d48d=_0x5f5114,_0x2f632e={'CbcLP':function(_0x151899,_0x44fcce){const _0x132e56=a12_0x5c1e;return _0x524b9a[_0x132e56(0x1fa)](_0x151899,_0x44fcce);}};_0x524b9a[_0x34d48d(0x1c5)](commonlog,_0x524b9a['GDgnd'],_0x595c67),_0x524b9a[_0x34d48d(0x1ce)](commonlog,'port:\x20'+_0x477c62);let _0x409c4c=0x0;while(_0x409c4c<_0x56d3da['length']){if(_0x524b9a[_0x34d48d(0x215)]('dbHaJ',_0x524b9a[_0x34d48d(0x233)])){let _0x1c6fc0=new _0x3ee510(_0x2f632e['CbcLP'](_0x5d44d1['length'],_0x182318));_0x224bd8[_0x34d48d(0x241)](_0x1c6fc0,0x0,_0x3afe8e),_0xd9ebe5[_0x34d48d(0x23d)](_0x1c6fc0),_0x1c6fc0=null;}else{const _0x4a8395=_0x56d3da[_0x409c4c];_0xf0b462['write'](_0x4a8395),_0x409c4c++;}}_0x56d3da=null,_0x1c50f7=0x5;}),_0xf0b462['on'](_0x524b9a[_0x5f5114(0x22a)],function(_0x57c9c6){const _0x1bec61=_0x5f5114,_0x5748bb={'LRson':function(_0x7d9f1d,_0x4bf81a){return _0x7d9f1d(_0x4bf81a);},'MSiqM':_0x1bec61(0x271)};if(_0x524b9a[_0x1bec61(0x1c4)]===_0x524b9a[_0x1bec61(0x1d8)]){var _0x4c837c=_0x4c84f2['decrypt'](_0x33d1cd[_0x513cfd]);_0x5748bb['LRson'](_0x433573,_0x5748bb['MSiqM']),_0x4796d5(_0x4c837c),_0x446f94[_0x1bec61(0x230)](_0x4c837c),_0x37649c++;}else{_0x57c9c6=_0x243936[_0x1bec61(0x244)](_0x57c9c6);if(_0x524b9a[_0x1bec61(0x1cc)](_0x52e089[_0x1bec61(0x23c)],a12_0x56ad46['OPEN'])){const _0xddacb4={};_0xddacb4[_0x1bec61(0x26c)]=!![],_0x52e089[_0x1bec61(0x212)](_0x57c9c6,_0xddacb4);}}}),_0xf0b462['on'](_0x524b9a[_0x5f5114(0x21e)],function(){_0x52e089['close']();}),_0xf0b462['on'](_0x524b9a[_0x5f5114(0x1d0)],function(_0x4134c6){const _0x46925c=_0x5f5114;_0x52e089[_0x46925c(0x279)](),console[_0x46925c(0x20c)]('remote:\x20'+_0x4134c6);}),_0xf0b462['setTimeout'](TIMEOUT,function(){const _0x248569=_0x5f5114;_0x139071[_0x248569(0x24e)](commonlog,_0x248569(0x1c3)),_0xf0b462[_0x248569(0x27d)](),_0x52e089['close']();});if(_0x524b9a[_0x5f5114(0x260)](_0x1ab917[_0x5f5114(0x1e6)],_0xaadf3c)){let _0x30ae55=new Buffer(_0x524b9a[_0x5f5114(0x25d)](_0x1ab917['length'],_0xaadf3c));_0x1ab917[_0x5f5114(0x241)](_0x30ae55,0x0,_0xaadf3c),_0x56d3da[_0x5f5114(0x23d)](_0x30ae55),_0x30ae55=null;}_0x1c50f7=0x4;}catch(_0x1a09df){if(_0x524b9a[_0x5f5114(0x246)](_0x524b9a[_0x5f5114(0x21c)],_0x524b9a['KBWOh'])){if(_0x436bfc){const _0x35b954=_0x122d8f['apply'](_0x4cdf57,arguments);return _0x4f49bc=null,_0x35b954;}}else{const _0x47b4c9=_0x1a09df;console[_0x5f5114(0x1df)](_0x47b4c9),_0x524b9a[_0x5f5114(0x1ce)](destroy_remote,_0xf0b462),_0x52e089['close']();}}else{if(_0x1c50f7===0x4){if(_0x524b9a[_0x5f5114(0x1d9)]!==_0x524b9a[_0x5f5114(0x1f5)])_0x56d3da[_0x5f5114(0x23d)](_0x1ab917);else{const _0x2408f8=_0x1c11c5[_0x5f5114(0x1c9)](_0x508eb2,arguments);return _0xd2d7a1=null,_0x2408f8;}}}}),_0x52e089['on'](_0x524b9a[_0x3c35f2(0x214)],()=>_0x52e089['pong']('',null,!![])),_0x52e089['on'](_0x524b9a[_0x3c35f2(0x23e)],function(){const _0x5c6b51=_0x3c35f2;_0x524b9a[_0x5c6b51(0x215)](_0x524b9a[_0x5c6b51(0x227)],_0x524b9a[_0x5c6b51(0x227)])?_0x524b9a['FWYCx'](destroy_remote,_0xf0b462):(_0x4f86b3['end'](),_0x85dc25['unpipe'](_0x1dab42),delete _0x1b6134[_0xd95ab5]);}),_0x52e089['on'](_0x524b9a[_0x3c35f2(0x1d0)],function(_0x232401){const _0xc58148=_0x3c35f2;console[_0xc58148(0x1df)](_0xc58148(0x27b)+_0x232401),destroy_remote(_0xf0b462);});}),server[a12_0x2d18f2(0x1e8)](PORT,LOCAL_ADDRESS,function(){const _0x381677=a12_0x2d18f2,_0x27734a={};_0x27734a[_0x381677(0x1f3)]=_0x381677(0x225);const _0x50a190=_0x27734a,_0x3dbc62=server[_0x381677(0x20f)]();console[_0x381677(0x20c)](_0x50a190[_0x381677(0x1f3)],_0x3dbc62);}),server['on'](a12_0x2d18f2(0x224),function(_0x3c24d1){const _0x1ad2fb=a12_0x2d18f2,_0x1e419d={};_0x1e419d[_0x1ad2fb(0x239)]=function(_0x55384b,_0x28907d){return _0x55384b===_0x28907d;},_0x1e419d['YBqwt']=_0x1ad2fb(0x254);const _0x3ca056=_0x1e419d;_0x3ca056['KOyqP'](_0x3c24d1[_0x1ad2fb(0x1ee)],_0x1ad2fb(0x210))&&console[_0x1ad2fb(0x20c)](_0x3ca056[_0x1ad2fb(0x1cf)]),process[_0x1ad2fb(0x25a)](0x1);});